# MouseLikeTouchPad_MacBook
仿鼠标式触摸板驱动程序macbook on windows10 touchpad driver

仿鼠标式触摸板是一种模拟鼠标功能的触摸板技术实现，当前的逻辑实现版本是发明人基于仿鼠标触摸板专利技术根据人手指操作时自然状态再次优化改进而成，3指完成鼠标左键/右键/中键和指针的操作，手指与鼠标的各个按键等部件的功能一一对应，其中的中指对应鼠标的指针定位器，食指对应鼠标左键和中键（食指与中指分开时定义为鼠标左键，食指与中指并拢时定义为鼠标中键），无名指对应鼠标右键，中无名并拢时对应鼠标垂直滚轮和水平滚轮。

手指与鼠标按键功能对应关系： 中指对应鼠标的指针定位器； 食指对应鼠标左键和中键，根据鼠标左键、中键普遍用食指操作的习惯及实际可行性来确定的，食指与中指分开时食指操作定义为鼠标左键，食指与中指并拢时食指操作定义为鼠标中键，食指与中指由分开状态切换为并拢状态时系统判定鼠标左键按下状态不变同时中键判定为按下状态，食指与中指由并拢状态切换为分开状态时系统判定鼠标中键释放同时左键判定为按下状态，食指与中指由并拢状态或者分开状态切换到食指离开触摸板时系统判定鼠标左键中键都是释放，； 无名指对应鼠标右键；根据鼠标右键、屏幕滚动操作的习惯及实际可行性来确定的，无名指与中指分开时无名指操作定义为鼠标右键，无名指与中指并拢时无名指中指合并操作定义为鼠标垂直或水平滚轮同时中指的指针定义保持不变但不会移动指针直到两指分开或者离开触摸板（正常中指无名指并拢滑动操作舒适性操作性最高并且一般中指比无名指更早接触到触摸板使得系统判定不会有歧义）。

多点电容式触摸板根据触摸点接触面形状很容易解决手掌的误触（打字时触摸板支撑手掌的椭圆接触面的长宽比特征比正常手指大很容易排除过滤掉）；

本人尝试过联系笔记本厂商、触摸板方案商甚至微软来提供逻辑实现方法但是没有渠道联系不上或者人家及大量IT人士认为没有价值所以最终决定自己开发，由于本人以前完全没有windows驱动开发经历所以只能查找现成的触摸板驱动代码改造完成，原本想开发触摸板硬件替换笔记本的触摸板但发现没有硬件资料和资金及技术实现难度太大转而在现有笔记本硬件上开发触摸板驱动，主流windows笔记本的触摸板驱动（因为windows系统比macos好用、笔记本硬件价格便宜并且普及适应性广），但是全球各大中外网络只找到了macbook笔记本硬件的windows版本驱动代码，期望能够修改后移植到普通windows笔记本硬件下。 

本驱动的基本框架为完全参考fanxiushu/kmouse_filter-AppleSPITrack-driver的实现：

https://github.com/fanxiushu/kmouse_filter-AppleSPITrack-driver

，少量参考

https://github.com/imbushuo/mac-precision-touchpad

的代码，感谢作者的开源代码，仿鼠标式触摸板的操作逻辑实现代码MouseLikeTouchPad_parse函数则是全部自己完成，本驱动替换Apple的AppleSPITrackpad驱动在macbook pro 2017版13寸不带bar的机器测试成功（其他版本估计也是可以的因为代码内没有和触摸板硬件相关的代码），安装后基本能够达到预期的逻辑实现目标。 

目前已经写了多个版本的逻辑算法实现在macbook硬件windows系统都存在各种奇怪的问题，食指/无名指和中指并拢操作时有一定概率会发生指针坐标突发性漂移（对操作影响不大，macbook硬件下原生macos系统和windows系统都同样存在但因为操作逻辑和仿鼠标触摸板不同不会有不良影响，初步怀疑是触摸板硬件的firmware固件设计上存在瑕疵无法通过电容准确计算两个手指的初始坐标，后续会通过数据分析特征解决）。

在系统驱动层逻辑上由于触摸板数据报告频率较低（<=125Hz）无法做到手指坐标的快速跟踪所以极快速滑动指针时会失去响应（手指触摸点移动太快导致坐标丢失），后续会通过其他手段改进。
macbook 0.1版驱动把坐标跟踪融合进了操作功能逻辑实现方法中，macbook 0.2版本在鼠标操作功能逻辑实现方法前面就先做了坐标跟踪算法更合理，macbook 0.3版本使用触摸点压力值Pressure、接触面长宽比ToolMajor/ToolMinor的阈值特征解决了键盘操作时触摸板误触问题并且可用性已经非常好了，未来macbook 0.4版本使用Mouse Collection集合Report报告表示传统按键指针操作和Windows Precision Touchpad Collection Report报告表示双指滚轮操作方式使得滑动拖拽更精细顺滑，并且加入三指手势和四指手势使得仿鼠标式触摸板功能包含了Precision Touchpad精确式触摸板的自定义手势更强大。

另外普通windows笔记本版本也已经开发完成并发布，大家可以免费下载使用，目前主流的windows笔记本触控板硬件基本上采用了I2C总线连接并且系统自带默认驱动使得厂家不需要另外开发专用驱动程序，macbook触摸板是SPI总线连接，所以需要本专用版本驱动。因为我试了macbook硬件下的驱动打上一个过期签名认证会蓝屏死机所以只能开驱动测试使用影响不大，windows笔记本版驱动签名后就可以正常使用无需开测试模式安装很方便，有兴趣的macbook用户朋友可以关闭强制驱动签名来安装试用，如果您特别希望有安装更简单安全的正式电子签名证书版本的用户可以进了本人淘宝店赞助链接（几元到十几元任意）达到10人以上我会先购买第三方安全认证的代签名电子证书后发布，本驱动会长期改进优化，能够普及仿鼠标式触摸板技术是我最大的心愿。

驱动安装方法： windows开始菜单右键点搜索cmd、找到命令提示符右键点管理员运行、输入bcdedit/set testsigning on关闭驱动强制签名后重启， Release\MouseLikeTouchPad目录中确保MouseLikeTouchPad.inf、MouseLikeTouchPad.sys、MouseLikeTouchPad.cat在同一文件夹下， 右键MouseLikeTouchPad.inf文件选择安装后点击始终安装此驱动程序软件， windows开始菜单右键打开设备管理器、点开人体学输入设备找到Apple SPI Trackpad打开、属性页面的驱动程序标签下点更新驱动程序后选浏览我的计算机以查找驱动程序软件、点让我从计算机上的可用驱动程序列表中选取、下方显示有MouseLikeTouchPad选中后下一步即可完成安装。

卸载方法： 设备管理器》人体学输入设备》MouseLikeTouchPad右键卸载设备》选中删除此设备的驱动程序软件复选框后卸载即可。

仿鼠标式触摸板专利作者：大余县乐友电子科技部 黄瑞平 相关资料： 

仿鼠标式触摸板实机演示https://www.bilibili.com/video/BV1Bh411Y7aY

仿鼠标式触摸板实机演示操作CS游戏https://www.bilibili.com/video/BV1qN411Z72r

笔记本电脑革命-仿鼠标式触摸板 视频演示 https://www.bilibili.com/video/av48712199

笔记本模式笔记本电脑革命-仿鼠标式触摸板 笔记本模式4K 视频演示 https://www.bilibili.com/video/av64713037

笔记本电脑办公神器-随时随地轻松操控 https://www.bilibili.com/read/cv2680213

仿鼠标式触摸板-笔记本电脑技术革命 https://www.bilibili.com/read/cv2522582

仿鼠标式触摸板技术原理说明书中文版 https://www.bilibili.com/read/cv2522031

免费开源驱动下载地址https://github.com/jxleyo

